{extend name="layout/main" /}

<!-- 这里需要和main.html中相同，使用block包裹 -->
{block name="content"}
<div class="wrap-con">
    <div class="con-header">
        <!-- 搜索框和分类筛选框 -->
        <div class="search-bar">
            <input type="text" id="keyword" class="layui-input" placeholder="请输入关键词"
                style="width: 200px; display: inline-block;">
            <select id="category" class="layui-select" style="width: 150px; display: inline-block;">
                <option value="">选择分类</option>
                <option value="1">分类 1</option>
                <option value="2">分类 2</option>
            </select>
            <button class="layui-btn" id="searchBtn">搜索</button>
            <button class="layui-btn layui-btn-normal" id="addBtn">新增</button>
            <button class="layui-btn layui-btn-danger" id="deleteBtn">删除</button>
        </div>
    </div>
    <div class="table-wrap">
        <!-- 将表格ID作为标识 -->
        <table class="layui-table" id="table-id"></table>
    </div>
</div>

<!-- 将layui-table的配置提取到一个JavaScript对象中 -->
<script>
    layui.use(['table'], function () {
        var table = layui.table;

        // 表格配置
        // https://layui.dev/docs/2/table/
        table.render({
            elem: '#table-id',
            url: '/{$baseConfig.adminRoutePrefix}/api/product/list',
            parseData:function(res){
                return {
                    code: res.code,
                    msg: res.message,
                    count: res.data.count,
                    data: res.data.content
                };
            },
            css: '.layui-table,.layui-table th{text-align: center;}',
            page: true, // 开启分页
            limit:20,
            limits:[20],
            method: 'post',
            request: {
                pageName: 'p',
            },
            response: {
                statusCode: 20826,
            },
            cols: [[
                 {
                    field: 'id',
                    title: '序号',
                    width: 80,
                    templet: function (d) {
                        return d.LAY_INDEX + 1;  // LAY_INDEX 是 layui 自动生成的索引
                    }
                },
                { field: 'title', title: '产品名称', width: 200 },
                { field: 'category_name', title: '分类', width: 200 },
                { field: 'summary', title: '描述' },
                { field: 'price', title: '价格', width: 100, sort: true },
                { field: 'created_at', title: '创建时间', width: 200 }
            ]]
        });
    });
</script>
{/block}