<style>
    /* 侧边栏 */
    .side {
        width: 230px;
        height: 100%;
        display: flex;
        flex-direction: column;
        padding: 16px;
        border-right: 1px solid #ededed;
        background-color: var(--sidebar-bg);
    }

    /* 标题 */
    .side .title {
        font-size: 23px;
        text-align: center;
        font-weight: bold;
    }

    /* 可滚动区域 */
    .side nav {
        flex: 1;
        overflow-y: auto;
    }

    /* 根菜单 */
    .menu-root {
        list-style: none;
        padding-left: 0;
        margin-top: 16px;
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    /* 每个菜单项 */
    .menu-item {
        list-style: none;
    }

    /* 菜单标题容器 */
    .menu-title {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 8px 12px;
        border-radius: 8px;
        cursor: pointer;
    }

    /* a 链接 */
    .menu-title a {
        flex: 1;
        font-size: 16px;
        color: var(--text-color);
        text-decoration: none;
    }

    /* hover */
    .menu-title:hover {
        background: var(--menu-item-hover);
        font-weight: bold;
    }

    /* active 高亮 */
    .menu-item.active > .menu-title {
        background: var(--menu-item-active);
        font-weight: bold;
    }

    .no-link{
        font-size: 16px;
    }

    /* 子菜单 */
    .submenu {
        list-style: none;
        padding-left: 16px;
        margin-top: 4px;
        display: none;
        flex-direction: column;
        gap: 4px;
    }

    /* 打开状态 */
    .submenu.open {
        display: flex;
    }

    /* 箭头 */
    .arrow {
        width: 0;
        height: 0;
        border-left: 5px solid transparent;
        border-right: 5px solid transparent;
        border-top: 6px solid var(--text-color);
        transition: transform 0.2s;
    }

    /* 旋转箭头 */
    .menu-title.open .arrow {
        transform: rotate(180deg);
    }
</style>
<div class="side">
    <h1 class="title">TPCMS</h1>
    <nav>
        <ul class="menu-root">

            {volist name="baseConfig.menu" id="item"}
            <li class="menu-item {if condition='$item.active'}active{/if}">

                <div class="menu-title {if condition='$item.active'}open{/if}">
                    {if !empty($item.url)}
                    <a href="{$item.url}">{$item.title}</a>
                    {else}
                    <span class="no-link">{$item.title}</span>
                    {/if}
                    {if !empty($item.children)}<span class="arrow"></span>{/if}
                </div>

                {if !empty($item.children)}
                <ul class="submenu {if condition='$item.active'}open{/if}">
                    {volist name="$item.children" id="child"}
                    <li class="menu-item {if condition='$child.active'}active{/if}">

                        <div class="menu-title {if condition='$child.active'}open{/if}">
                            {if !empty($child.url)}
                            <a href="{$child.url}">{$child.title}</a>
                            {else}
                            <span class="no-link">{$child.title}</span>
                            {/if}
                        </div>

                        {if !empty($child.children)}
                        <ul class="submenu {if condition='$child.active'}open{/if}">
                            {volist name="$child.children" id="grand"}
                            <li class="menu-item {if condition='$grand.active'}active{/if}">
                                <div class="menu-title">
                                    <a href="{$grand.url}">{$grand.title}</a>
                                </div>
                            </li>
                            {/volist}
                        </ul>
                        {/if}

                    </li>
                    {/volist}
                </ul>
                {/if}

            </li>
            {/volist}

        </ul>
    </nav>
</div>



<script>
    document.addEventListener("DOMContentLoaded", function () {
        // 遍历所有有子菜单的一级菜单
        document.querySelectorAll(".menu-item > .menu-title").forEach(function (title) {
            let submenu = title.nextElementSibling;
            let link = title.querySelector('a');

            // 只有有子菜单才处理折叠
            if (!submenu) return;

            title.querySelector('.arrow')?.addEventListener("click", function (e) {
                e.stopPropagation(); // 阻止冒泡
                submenu.classList.toggle("open");
                title.classList.toggle("open");
            });

            // 如果父菜单没有 url，点击整个 title 都折叠
            if (!link) {
                title.addEventListener("click", function () {
                    submenu.classList.toggle("open");
                    title.classList.toggle("open");
                });
            }
        });
    });
</script>